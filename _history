{"entries":[{"timestamp":1750908909983,"editorVersion":"2.0.35","changes":[{"type":"edited","filename":"main.blocks","patch":[{"diffs":[[0,"http"],[-1,"s"],[0,"://"],[-1,"developers.google.com/blockly/xml\"><variables></variables>"],[1,"www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"minecraftOnChat\">\n    <value name=\"command\">\n      <shadow type=\"text\">\n        <field name=\"TEXT\">run</field>\n      </shadow>\n    </value>\n  </block>\n"],[0,"</xm"]],"start1":12,"start2":12,"length1":70,"length2":239}]},{"type":"edited","filename":"main.ts","patch":[{"diffs":[[-1,"player.onChat(\"buildtunnel\", function () {\n        // 通道參數\n            let tunnelLength = 20; // L 格，通道長度\n                let tunnelHalfWidth = 6; // 半寬：6格\n                    let tunnelHalfHeight = 6; // 半高：6格\n\n                        // 獲取玩家當前位置\n                            let playerPos = player.position();\n                                let playerX = playerPos.x;\n                                    let playerY = playerPos.y;\n                                        let playerZ = playerPos.z;\n\n                                            // 獲取玩家水平朝向 (Yaw)，範圍通常是 -180 到 180\n                                                // 0度: 南 (+Z)\n                                                    // 90度: 東 (-X)\n                                                        // 180度/-180度: 北 (-Z)\n                                                            // -90度: 西 (+X)\n                                                                let playerYaw = player.rotation(); // 獲取玩家水平旋轉角度\n\n                                                                    // 根據玩家朝向判斷建造方向\n                                                                        let startX, startY, startZ; // 通道外框的起始點\n                                                                            let endX, endY, endZ;     // 通道外框的結束點\n                                                                                let innerStartX, innerStartY, innerStartZ; // 通道內部的起始點\n                                                                                    let innerEndX, innerEndY, innerEndZ;     // 通道內部的結束點\n\n                                                                                        // 方塊類型：透明玻璃 (Block.Glass)\n                                                                                            let glassBlock = Block.Glass;\n                                                                                                let airBlock = Block.Air;\n\n                                                                                                    // 判斷玩家最接近哪個主軸方向\n                                                                                                        // 為了簡化邏輯，我們將角度轉換為 0-360 範圍，並調整為標準羅盤方向\n                                                                                                            // 0度為北，90度為東，180度為南，270度為西\n                                                                                                                let normalizedYaw = (playerYaw + 360) % 360; // 轉換到 0-360 範圍\n                                                                                                                    \n                                                                                                                        // 根據角度判斷方向\n                                                                                                                            // 北 (-Z): 315 度到 45 度 (或 -45 到 45)\n                                                                                                                                // 東 (-X): 45 度到 135 度\n                                                                                                                                    // 南 (+Z): 135 度到 225 度\n                                                                                                                                        // 西 (+X): 225 度到 315 度\n\n                                                                                                                                            if (normalizedYaw >= 315 || normalizedYaw < 45) { // 朝向 北 (-Z)\n                                                                                                                                                    game.say(\"建造通道：朝向北方 (-Z)\");\n                                                                                                                                                            startX = playerX - tunnelHalfWidth;\n                                                                                                                                                                    endX = playerX + tunnelHalfWidth;\n                                                                                                                                                                            startY = playerY - tunnelHalfHeight;\n                                                                                                                                                                                    endY = playerY + tunnelHalfHeight;\n                                                                                                                                                                                            startZ = playerZ - 1; // 從玩家後方一格開始建造，避免玩家被困住\n                                                                                                                                                                                                    endZ = playerZ - tunnelLength;\n\n                                                                                                                                                                                                            innerStartX = startX + 1;\n                                                                                                                                                                                                                    innerEndX = endX - 1;\n                                                                                                                                                                                                                            innerStartY = startY + 1;\n                                                                                                                                                                                                                                    innerEndY = endY - 1;\n                                                                                                                                                                                                                                            innerStartZ = startZ - 1;\n                                                                                                                                                                                                                                                    innerEndZ = endZ + 1;\n\n                                                                                                                                                                                                                                                        } else if (normalizedYaw >= 45 && normalizedYaw < 135) { // 朝向 東 (-X)\n                                                                                                                                                                                                                                                                game.say(\"建造通道：朝向東方 (-X)\");\n                                                                                                                                                                                                                                                                        startX = playerX - 1; // 從玩家後方一格開始建造\n                                                                                                                                                                                                                                                                                endX = playerX - tunnelLength;\n                                                                                                                                                                                                                                                                                        startY = playerY - tunnelHalfHeight;\n                                                                                                                                                                                                                                                                                                endY = playerY + tunnelHalfHeight;\n                                                                                                                                                                                                                                                                                                        startZ = playerZ - tunnelHalfWidth;\n                                                                                                                                                                                                                                                                                                                endZ = playerZ + tunnelHalfWidth;\n\n                                                                                                                                                                                                                                                                                                                        innerStartX = startX - 1;\n                                                                                                                                                                                                                                                                                                                                innerEndX = endX + 1;\n                                                                                                                                                                                                                                                                                                                                        innerStartY = startY + 1;\n                                                                                                                                                                                                                                                                                                                                                innerEndY = endY - 1;\n                                                                                                                                                                                                                                                                                                                                                        innerStartZ = startZ + 1;\n                                                                                                                                                                                                                                                                                                                                                                innerEndZ = endZ - 1;\n\n                                                                                                                                                                                                                                                                                                                                                                    } else if (normalizedYaw >= 135 && normalizedYaw < 225) { // 朝向 南 (+Z)\n                                                                                                                                                                                                                                                                                                                                                                            game.say(\"建造通道：朝向南方 (+Z)\");\n                                                                                                                                                                                                                                                                                                                                                                                    startX = playerX - tunnelHalfWidth;\n                                                                                                                                                                                                                                                                                                                                                                                            endX = playerX + tunnelHalfWidth;\n                                                                                                                                                                                                                                                                                                                                                                                                    startY = playerY - tunnelHalfHeight;\n                                                                                                                                                                                                                                                                                                                                                                                                            endY = playerY + tunnelHalfHeight;\n                                                                                                                                                                                                                                                                                                                                                                                                                    startZ = playerZ + 1; // 從玩家前方一格開始建造\n                                                                                                                                                                                                                                                                                                                                                                                                                            endZ = playerZ + tunnelLength;\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                    innerStartX = startX + 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                            innerEndX = endX - 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                    innerStartY = startY + 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                            innerEndY = endY - 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                    innerStartZ = startZ + 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                            innerEndZ = endZ - 1;\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } else { // 朝向 西 (+X) (normalizedYaw >= 225 && normalizedYaw < 315)\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        game.say(\"建造通道：朝向西方 (+X)\");\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                startX = playerX + 1; // 從玩家前方一格開始建造\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        endX = playerX + tunnelLength;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                startY = playerY - tunnelHalfHeight;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        endY = playerY + tunnelHalfHeight;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                startZ = playerZ - tunnelHalfWidth;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        endZ = playerZ + tunnelHalfWidth;\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                innerStartX = startX + 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        innerEndX = endX - 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                innerStartY = startY + 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        innerEndY = endY - 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                innerStartZ = startZ + 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        innerEndZ = endZ - 1;\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // 建造外部玻璃框架 (實心玻璃長方體)\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // 注意：setBlocks 函數的參數順序是 (x1, y1, z1, x2, y2, z2, blockType)\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // 並且它會自動處理 x1 > x2 的情況，所以可以直接使用計算出的起始和結束點\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            blocks.fill(\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    glassBlock,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            world(startX, startY, startZ),\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    world(endX, endY, endZ),\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            FillOperation.Replace\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                );\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // 在內部填充空氣，形成中空通道\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // 確保內部空間至少為 1x1x1，否則無法挖空\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (Math.abs(innerEndX - innerStartX) >= 0 && Math.abs(innerEndY - innerStartY) >= 0) {\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    blocks.fill(\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                airBlock,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            world(innerStartX, innerStartY, innerStartZ),\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        world(innerEndX, innerEndY, innerEndZ),\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    FillOperation.Replace\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            );\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } else {\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        game.say(\"通道內部空間不足，無法挖空。請檢查半寬/半高設定。\");\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                game.say(\"透明玻璃通道建造完成！\");\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                });\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \n})"],[1,"\n"]],"start1":0,"start2":0,"length1":41774,"length2":1}]},{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0,"   \""],[-1,"testFiles\": [\n        \"test.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\""],[1,"additionalFilePaths\": []"],[0,"\n}\n"]],"start1":202,"start2":202,"length1":76,"length2":31}]},{"type":"added","filename":"test.ts","value":"// 在這裡測試；當此封包作為擴充功能時，將不會編譯此內容。\n"}]}],"snapshots":[{"timestamp":1750908909982,"editorVersion":"2.0.35","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"minecraftOnChat\">\n    <value name=\"command\">\n      <shadow type=\"text\">\n        <field name=\"TEXT\">run</field>\n      </shadow>\n    </value>\n  </block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"未命名\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"builder\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}}],"shares":[],"lastSaveTime":1750909045393}